# データベース - 詳細コンテンツ仕様書

## 📋 ドキュメント情報
- 作成日: 2025-10-07
- カテゴリ: テクノロジ系
- 重要度: ★★★★☆
- 推定学習時間: 4時間

## 🎯 この分野の学習目標
- データベースとDBMSの基本概念を理解する
- 関係データベースの構造（テーブル、キー、リレーションシップ）を説明できる
- SQLの基本文（SELECT、WHERE、JOIN）を理解し、簡単な問い合わせができる
- 正規化の目的と手順（第1〜第3正規形）を理解する
- トランザクション処理とACID特性を説明できる

## 📚 セクション構成

### セクション3-1: データベースの基礎（推定60分）

#### 学習目標
- データベースとファイルシステムの違いを理解する
- DBMS（データベース管理システム）の役割と機能を理解する
- データベースの種類（階層型、ネットワーク型、関係型）を区別できる
- データベースを使用する利点を説明できる

#### コンテンツ概要
データベースは、複数のユーザーやアプリケーションがデータを共有・利用するためのシステムです。従来のファイルシステムと比べて、データの一貫性、整合性、セキュリティが向上します。DBMS（Database Management System）は、データの定義、操作、制御を統合的に管理するソフトウェアです。データベースには階層型、ネットワーク型、関係型などがありますが、現在最も広く使われているのは関係型データベース（RDB）です。データを表（テーブル）形式で管理し、SQL言語でデータを操作します。

#### 📌 重要ポイント
1. **データベースの利点**: データの一元管理、重複排除、整合性維持、同時アクセス制御、セキュリティ強化
2. **DBMSの3大機能**: データ定義（DDL：テーブル作成）、データ操作（DML：検索・更新）、データ制御（DCL：権限管理）
3. **関係データベースの特徴**: データを表（テーブル）形式で管理、行（レコード）と列（カラム）で構成、SQL言語を使用
4. **スキーマ**: データベースの構造定義、外部スキーマ（ユーザー視点）、概念スキーマ（全体構造）、内部スキーマ（物理的格納）
5. **データ独立性**: 論理データ独立性（スキーマ変更がアプリに影響しない）、物理データ独立性（格納方法変更がスキーマに影響しない）

#### 💡 例題案
**問題1**: DBMS の役割として、適切でないものはどれか。
```
ア. データの定義と管理
イ. データへのアクセス制御
ウ. 複数ユーザーの同時アクセス制御
エ. アプリケーションプログラムの開発
```

**解答**: エ

**解説**: DBMSの主な役割は、データの定義・操作・制御です。具体的には、データの定義（テーブル構造の定義）、データ操作（検索・更新・削除）、アクセス制御（権限管理）、同時実行制御（複数ユーザーの競合回避）などです。アプリケーションプログラムの開発は別のツール（IDE等）の役割です。

**問題2**: 関係データベースの説明として、最も適切なものはどれか。
```
ア. データを木構造で階層的に管理する
イ. データをネットワーク構造で管理する
ウ. データを表形式で管理する
エ. データをオブジェクトとして管理する
```

**解答**: ウ

**解説**: 関係データベース（RDB：Relational Database）は、データを表（テーブル）形式で管理します。各テーブルは行（レコード、タプル）と列（カラム、属性）で構成され、表同士を関連付けて管理します。選択肢アは階層型、イはネットワーク型、エはオブジェクト指向型データベースの説明です。

#### 🖼️ 必要な図解
- **図解1: ファイルシステムとデータベースの比較** - データの重複、整合性、共有の観点から違いを図示
- **図解2: DBMSの位置づけ** - ユーザー/アプリケーション → DBMS → データベースの関係図
- **図解3: データベースの種類** - 階層型、ネットワーク型、関係型の構造を視覚的に比較
- **図解4: 3層スキーマ** - 外部スキーマ、概念スキーマ、内部スキーマの関係と役割

---

### セクション3-2: 関係データベース（推定60分）

#### 学習目標
- テーブル、レコード、フィールドの概念を理解する
- 主キーと外部キーの役割と制約を理解する
- リレーションシップ（1対1、1対多、多対多）を説明できる
- ER図の基本的な読み方と書き方を理解する

#### コンテンツ概要
関係データベースは、データを表（テーブル）で管理します。テーブルは行（レコード）と列（フィールド）で構成され、各レコードは1件のデータを表します。主キーは各レコードを一意に識別するフィールドで、重複や NULL 値は許されません。外部キーは他のテーブルの主キーを参照し、テーブル間の関連を表します。リレーションシップには、1対1（1つのレコードが相手テーブルの1つと対応）、1対多（1つが複数と対応）、多対多（複数が複数と対応）の3種類があります。ER図はエンティティとリレーションシップを視覚的に表現する設計図です。

#### 📌 重要ポイント
1. **テーブル構造**: 行（レコード、タプル）= データの1件、列（フィールド、属性、カラム）= データ項目
2. **主キー（Primary Key）**: レコードを一意に識別、重複不可、NULL不可、変更されない値を選ぶ
3. **外部キー（Foreign Key）**: 他テーブルの主キーを参照、参照整合性制約（存在しない値は参照不可）
4. **リレーションシップの種類**:
   - 1対1: 社員テーブル ←→ 社員詳細テーブル
   - 1対多: 部署テーブル ←→ 社員テーブル（1部署に複数社員）
   - 多対多: 学生テーブル ←→ 科目テーブル（履修中間テーブルで分解）
5. **ER図の記法**: エンティティ（四角）、リレーションシップ（ひし形）、属性（楕円）、カーディナリティ（1:1、1:N、M:N）

#### 💡 例題案
**問題1**: 主キーの条件として、適切でないものはどれか。
```
ア. レコードを一意に識別できる
イ. NULL 値を含むことができる
ウ. 重複した値を持つことができない
エ. できるだけ変更されない値を選ぶ
```

**解答**: イ

**解説**: 主キー（Primary Key）は各レコードを一意に識別するための属性で、以下の制約があります：1) 重複不可、2) NULL不可、3) 変更されない値が望ましい。NULL値を許すと「どのレコードかわからない」状態になるため、主キーにはNULLを設定できません。

**問題2**: 次のテーブル構造で、外部キーとして適切なものはどれか。
```
【社員テーブル】
社員ID（主キー）、氏名、部署ID、入社日

【部署テーブル】
部署ID（主キー）、部署名、所在地
```

**解答**: 社員テーブルの部署ID

**解説**: 外部キーは、他のテーブルの主キーを参照する属性です。社員テーブルの「部署ID」は、部署テーブルの主キー「部署ID」を参照しており、これが外部キーです。この設定により、存在しない部署IDを社員テーブルに登録できなくなり、データの整合性が保たれます。

**問題3**: ER図で、1対多のリレーションシップを表すとき、"多"側のエンティティに何を追加するか。
```
ア. 新しい主キー
イ. "1"側の主キーを外部キーとして追加
ウ. 中間テーブル
エ. 複合キー
```

**解答**: イ

**解説**: 1対多のリレーションシップ（例：1つの部署に複数の社員）を実装するには、"多"側（社員テーブル）に"1"側（部署テーブル）の主キーを外部キーとして追加します。これにより、各社員がどの部署に所属するかを表現できます。選択肢ウの中間テーブルは多対多のときに使用します。

#### 🖼️ 必要な図解
- **図解1: テーブルの構造** - 行（レコード）、列（フィールド）、主キー、外部キーを実際のテーブル例で図示
- **図解2: 主キーと外部キーの関係** - 2つのテーブル間の参照関係を矢印で示す
- **図解3: リレーションシップの種類** - 1対1、1対多、多対多の具体例（社員と部署、学生と科目など）
- **図解4: ER図の例** - 社員・部署・プロジェクトなどのエンティティと関連を図示
- **図解5: 多対多の分解** - 学生と科目の多対多関係を、履修テーブルを使って1対多に分解

---

### セクション3-3: SQL（推定60分）

#### 学習目標
- SELECT文の基本構文を理解し、データを取得できる
- WHERE句で条件を指定してデータを絞り込める
- JOIN（内部結合）で複数テーブルを結合できる
- 集計関数（COUNT、SUM、AVG、MAX、MIN）を使用できる

#### コンテンツ概要
SQL（Structured Query Language）は、関係データベースを操作するための言語です。SELECT文はデータを取得するための基本命令で、「SELECT カラム名 FROM テーブル名」の形式です。WHERE句で条件を指定してデータを絞り込み、ORDER BY句で並び替えができます。JOIN（結合）は複数のテーブルを組み合わせてデータを取得する操作で、内部結合（INNER JOIN）、外部結合（LEFT/RIGHT JOIN）などがあります。集計関数は、COUNT（件数）、SUM（合計）、AVG（平均）、MAX（最大）、MIN（最小）などで、GROUP BY句と組み合わせてグループごとの集計を行います。

#### 📌 重要ポイント
1. **SELECT文の基本**: SELECT カラム FROM テーブル WHERE 条件 ORDER BY カラム
2. **WHERE句の演算子**: =（等しい）、<>（等しくない）、>、<、>=、<=、BETWEEN、IN、LIKE（パターンマッチ）
3. **JOIN（結合）**: INNER JOIN（両方に存在するデータ）、LEFT JOIN（左側全て）、RIGHT JOIN（右側全て）
4. **集計関数**: COUNT（件数）、SUM（合計）、AVG（平均）、MAX（最大値）、MIN（最小値）
5. **GROUP BY**: グループごとに集計、HAVING句でグループ化後の条件指定
6. **ワイルドカード**: %（任意の文字列）、_（任意の1文字）、LIKEと組み合わせて使用

#### 💡 例題案
**問題1**: 次の SQL文の実行結果として、正しいものはどれか。
```sql
SELECT 氏名, 年齢 FROM 社員 WHERE 年齢 >= 30 ORDER BY 年齢 DESC
```
【社員テーブル】
| 社員ID | 氏名 | 年齢 | 部署 |
|-------|-----|-----|-----|
| 1 | 田中 | 25 | 営業 |
| 2 | 佐藤 | 35 | 開発 |
| 3 | 鈴木 | 30 | 営業 |
| 4 | 高橋 | 28 | 総務 |

**解答**:
| 氏名 | 年齢 |
|-----|-----|
| 佐藤 | 35 |
| 鈴木 | 30 |

**解説**: WHERE句で年齢が30以上のレコードを絞り込み（佐藤と鈴木）、ORDER BY 年齢 DESC で年齢の降順に並べ替えます。SELECT句で氏名と年齢のみを取得するため、この2列だけが表示されます。

**問題2**: 次の SQL文で、部署ごとの社員数を集計するとき、空欄に入る句はどれか。
```sql
SELECT 部署, COUNT(*) FROM 社員 _____ 部署
```

**解答**: GROUP BY

**解説**: グループごとの集計を行うには GROUP BY 句を使用します。「GROUP BY 部署」により部署ごとにグループ化され、各グループで COUNT(*) が実行されて社員数がカウントされます。集計関数（COUNT、SUM、AVGなど）を使う場合は、GROUP BY句でグループ化の基準を指定します。

**問題3**: INNER JOIN の説明として、最も適切なものはどれか。
```
ア. 左側のテーブルの全レコードと、右側の一致するレコードを結合
イ. 両方のテーブルで一致するレコードのみを結合
ウ. 右側のテーブルの全レコードと、左側の一致するレコードを結合
エ. 両方のテーブルの全レコードを結合
```

**解答**: イ

**解説**: INNER JOIN（内部結合）は、両方のテーブルで結合条件に一致するレコードのみを結合します。例えば、社員テーブルと部署テーブルを部署IDで結合する場合、部署IDが一致する社員だけが結果に含まれます。選択肢アは LEFT JOIN、ウは RIGHT JOIN の説明です。

#### 🖼️ 必要な図解
- **図解1: SELECT文の構文図** - SELECT、FROM、WHERE、ORDER BY の役割と記述順序
- **図解2: WHERE句の演算子一覧** - =、<>、>、<、BETWEEN、IN、LIKE の使用例
- **図解3: JOIN の種類と結果** - INNER JOIN、LEFT JOIN、RIGHT JOIN のベン図とデータ例
- **図解4: GROUP BYの動作** - グループ化前のテーブル → グループ化 → 集計結果の流れ
- **図解5: 集計関数の使用例** - COUNT、SUM、AVG、MAX、MIN の具体的な計算例

---

### セクション3-4: データベース設計（推定60分）

#### 学習目標
- 正規化の目的と利点を理解する
- 第1正規形、第2正規形、第3正規形の定義と手順を理解する
- トランザクションの概念を理解する
- ACID特性（原子性、一貫性、独立性、永続性）を説明できる
- ロックとデッドロックの問題を理解する

#### コンテンツ概要
データベース設計では、データの冗長性を排除し、整合性を保つために正規化を行います。正規化は段階的に進め、第1正規形（繰り返し項目の排除）、第2正規形（部分関数従属の排除）、第3正規形（推移的関数従属の排除）の順に行います。トランザクションは、複数の処理をまとめて1つの作業単位として扱う機能で、ACID特性（Atomicity:原子性、Consistency:一貫性、Isolation:独立性、Durability:永続性）を満たす必要があります。複数ユーザーが同時にアクセスする際は、ロック機構でデータの整合性を保ちますが、デッドロック（相互に待ち合う状態）に注意が必要です。

#### 📌 重要ポイント
1. **正規化の目的**: データの冗長性排除、更新異常の防止、整合性の維持
2. **第1正規形**: 繰り返し項目を別テーブルに分離、各セルに単一の値
3. **第2正規形**: 部分関数従属を排除、主キーの一部に依存する項目を分離
4. **第3正規形**: 推移的関数従属を排除、主キー以外の項目に依存する項目を分離
5. **ACID特性**:
   - Atomicity（原子性）: 全て実行か全て未実行、中途半端なし
   - Consistency（一貫性）: トランザクション前後でデータの整合性維持
   - Isolation（独立性）: 複数トランザクションが互いに干渉しない
   - Durability（永続性）: 完了したトランザクションの結果は永続的に保存
6. **ロック**: 共有ロック（読み取り可、書き込み不可）、専有ロック（読み書き不可）
7. **デッドロック**: 2つのトランザクションが互いに相手のロック解除を待つ状態

#### 💡 例題案
**問題1**: 次のテーブルを第1正規形にするための処理として、適切なものはどれか。
```
【受注テーブル】
受注番号 | 顧客名 | 商品1 | 商品2 | 商品3
-------|-------|------|------|------
001    | A社   | ペン  | ノート |
002    | B社   | 消しゴム | |
```

**解答**: 商品を別テーブルに分離し、受注番号と商品の組み合わせで管理する

**解説**: 第1正規形では、繰り返し項目（商品1、商品2、商品3）を排除します。受注明細テーブルを作成し、「受注番号、商品、数量」のように1レコード1商品として管理します。これにより、商品数が変動しても柔軟に対応でき、空欄（NULL）も発生しません。

**問題2**: ACID特性のうち、「トランザクションは全て実行されるか、全て実行されないか」という性質はどれか。
```
ア. Atomicity（原子性）
イ. Consistency（一貫性）
ウ. Isolation（独立性）
エ. Durability（永続性）
```

**解答**: ア

**解説**: Atomicity（原子性）は、トランザクション内の処理が全て成功するか、全て失敗するかのいずれかになる性質です。例えば、銀行の振込処理で「口座Aから引き出し」と「口座Bへ入金」の両方が成功するか、両方が取り消されるかが保証されます。中途半端な状態（片方だけ実行）は発生しません。

**問題3**: デッドロックの説明として、最も適切なものはどれか。
```
ア. 複数のトランザクションが同じデータを同時に更新しようとする状態
イ. トランザクションが完了せずに無限に待ち続ける状態
ウ. 2つのトランザクションが互いに相手のロック解除を待つ状態
エ. データベースへのアクセスが集中してレスポンスが遅くなる状態
```

**解答**: ウ

**解説**: デッドロック（deadlock：膠着状態）は、トランザクションAがリソース1をロックしてリソース2を待ち、トランザクションBがリソース2をロックしてリソース1を待つという、相互に待ち合う状態です。このままでは両方とも進まないため、DBMSがデッドロックを検出し、一方のトランザクションを強制終了（ロールバック）して解決します。

#### 🖼️ 必要な図解
- **図解1: 正規化の段階** - 非正規形 → 第1正規形 → 第2正規形 → 第3正規形の変化を具体例で図示
- **図解2: 第1正規形への変換** - 繰り返し項目を持つテーブルを分離する手順
- **図解3: トランザクションのACID特性** - 各特性の意味と具体例を視覚化
- **図解4: ロックの種類** - 共有ロックと専有ロックの違い、同時アクセス時の動作
- **図解5: デッドロックの発生** - 2つのトランザクションが互いに待ち合う状態を時系列で図示

---

## 🎯 分野全体の重要キーワード

### データベース基礎
- DBMS、スキーマ、DDL、DML、DCL
- 関係データベース、テーブル、レコード、フィールド
- データ独立性、データ整合性

### 関係データベース
- 主キー、外部キー、参照整合性
- リレーションシップ（1対1、1対多、多対多）
- ER図、エンティティ、カーディナリティ

### SQL
- SELECT、FROM、WHERE、ORDER BY
- JOIN（INNER、LEFT、RIGHT）
- 集計関数（COUNT、SUM、AVG、MAX、MIN）
- GROUP BY、HAVING

### データベース設計
- 正規化（第1、第2、第3正規形）
- 関数従属、部分関数従属、推移的関数従属
- トランザクション、ACID特性
- ロック、デッドロック、ロールバック、コミット

---

## 📊 学習効果測定

### 理解度チェックポイント
- [ ] DBMSの役割と機能を説明できる
- [ ] 主キーと外部キーの違いを理解している
- [ ] リレーションシップの種類を区別できる
- [ ] ER図を読み解ける
- [ ] 基本的なSELECT文を記述できる
- [ ] JOINで複数テーブルを結合できる
- [ ] 集計関数とGROUP BYを使える
- [ ] 正規化の各段階を説明できる
- [ ] ACID特性を理解している
- [ ] デッドロックの概念を理解している

### 想定される試験問題パターン
1. DBMSの機能に関する問題
2. 主キー・外部キーの役割に関する問題
3. リレーションシップの種類に関する問題
4. ER図の読解問題
5. SQL文の実行結果を問う問題
6. JOINの種類と結果に関する問題
7. 集計関数とGROUP BYに関する問題
8. 正規化の手順に関する問題
9. トランザクションとACID特性に関する問題
10. ロックとデッドロックに関する問題

---

## 🔗 関連分野との接続

### 前提知識
- **アルゴリズムとプログラミング**: データ構造（特に木構造、ハッシュ）
- 基本的な論理演算

### 次のステップ
- **システム開発**: データベース設計、ER図作成
- **セキュリティ**: SQLインジェクション対策、アクセス制御
- **ネットワーク**: クライアント・サーバーシステム

---

## ✅ このドキュメントの使い方

1. **学習前**: セクション構成を確認し、全体像を把握する
2. **学習中**:
   - テーブル構造を実際に紙に書いて理解する
   - SQL文を自分で書いて実行結果を予想する
   - 正規化の手順を具体例で追いかける
3. **学習後**:
   - 例題を解き、理解度チェックポイントで確認する
   - ER図を自分で書いてみる
4. **試験直前**:
   - 重要キーワードを復習する
   - SQL文の読解問題を繰り返し練習する
   - 正規化の手順を確認する

---

**最終更新日**: 2025-10-07
